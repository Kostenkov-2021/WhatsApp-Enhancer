# WhatsApp Desktop Enhancer (Улучшение для WhatsApp Desktop на WebView2)

**Автор:** mrido1

WhatsApp Desktop Enhancer — это специализированный мост для улучшения доступности, созданный для **современного настольного приложения WhatsApp** (доступного в Microsoft Store). Это дополнение упрощает навигацию и устраняет критические проблемы взаимодействия, вызванные недавними изменениями в базовых технологиях WhatsApp.

> [!NOTE]
> ### Зачем нужно это дополнение?
>
> Версия WhatsApp для Windows претерпела несколько серьёзных архитектурных изменений, что привело к значительным проблемам с доступностью:
>
> *   **Эпоха нативного приложения (UWP):** В период с **2021 по 2022 год** WhatsApp выпустил нативную версию UWP, которая предлагала превосходную производительность и бесшовную поддержку программ экранного доступа. Она широко считалась «золотым стандартом» доступности.
> *   **Эпоха WebView2:** Начиная с **конца 2025 года**, WhatsApp перешёл на гибридный веб-движок (WebView2). Хотя это позволило упростить кросс-платформенные обновления, оно привело к серьёзным регрессиям для пользователей программ экранного доступа, включая нестабильность фокуса и конфликтные ситуации с «Режимом обзора» (Browse Mode).
>
> **Проблема:** Поскольку новое приложение является веб-ориентированным, NVDA часто некорректно активирует «Режим обзора». Это мешает работе стандартных сочетаний клавиш (таких как `Ctrl+F`) и затрудняет ввод текста. Кроме того, фокус часто «застревает» внутри элементов списка.
>
> **Решение:** Это дополнение оптимизирует взаимодействие, **автоматически отключая и блокируя Режим обзора**, заставляя NVDA обращаться с WhatsApp как со стандартным настольным приложением. Хотя эта блокировка активна по умолчанию для обеспечения стабильности, опытные пользователи могут отключить её в настройках (хотя это обычно не рекомендуется).

## Встроенные нативные сочетания клавиш (Настоятельно рекомендуется)

Поскольку современное приложение WhatsApp создано для навигации с помощью клавиатуры, мы настоятельно рекомендуем отдавать приоритет встроенным сочетаниям клавиш. Они по своей природе быстрее и надёжнее любых сторонних скриптов.

### Управление чатами

| Сочетание клавиш | Действие |
| :--- | :--- |
| `Ctrl + Shift + U` | Пометить как непрочитанное |
| `Ctrl + Shift + M` | Отключить уведомления (заглушить) |
| `Ctrl + Shift + A` | Архивировать чат |
| `Ctrl + Alt + Shift + P` | Закрепить чат |
| `Ctrl + ]` | Следующий чат |
| `Ctrl + [` | Предыдущий чат |
| `Ctrl + Shift + N` | Новая группа |
| `Ctrl + Alt + N` | Новый чат |
| `Escape` | Закрыть чат |
| `Ctrl + Shift + B` | Заблокировать чат |
| `Ctrl + Alt + Shift + L` | Добавить метку к чату (для WhatsApp Business) |

### Навигация и поиск

| Сочетание клавиш | Действие |
| :--- | :--- |
| `Ctrl + Alt + /` | Глобальный поиск |
| `Ctrl + Shift + F` | Поиск в текущем чате |
| `Alt + K` | Расширенный поиск |
| `Ctrl + Alt + P` | Профиль и информация |
| `Alt + I` | Открыть информацию о чате |
| `Alt + S` | Настройки |
| `Alt + L` | Заблокировать приложение |
| `Ctrl + 1..9` | Перейти к чату (по позиции) |

### Действия с сообщениями

| Сочетание клавиш | Действие |
| :--- | :--- |
| `Alt + R` | Ответить |
| `Ctrl + Alt + R` | Ответить приватно |
| `Ctrl + Alt + D` | Переслать |
| `Alt + 8` | Добавить сообщение в избранное |
| `Ctrl + Стрелка вверх` | Редактировать последнее сообщение |
| `Alt + A` | Открыть панель вложений |
| `Ctrl + Alt + E` | Панель эмодзи |
| `Ctrl + Alt + G` | Панель GIF |
| `Ctrl + Alt + S` | Панель стикеров |

### Голосовые сообщения (PTT)

| Сочетание клавиш | Действие |
| :--- | :--- |
| `Shift + .` | Увеличить скорость воспроизведения |
| `Shift + ,` | Уменьшить скорость воспроизведения |
| `Ctrl + Enter` | Отправить голосовое сообщение |
| `Alt + P` | Приостановить запись |
| `Ctrl + Alt + Shift + R` | Выделить запись |

---

## Улучшенные функции дополнения

Эти инструменты дополняют нативный опыт работы с WhatsApp, устраняя оставшиеся пробелы в доступности.

### 1. Улучшенное чтение сообщений
Если сообщение слишком длинное или фокус становится ненадёжным, используйте эти инструменты для лучшего контроля.

*   **Просмотр в отдельном окне (`Alt + C`):** Открывает выделенное сообщение в отдельном окне только для чтения. Это позволяет перемещаться по строкам с помощью курсорных стрелок или выбирать определённые части текста. Нажмите `Escape`, чтобы закрыть это окно.
*   **Быстрое копирование (`Ctrl + C`):** Немедленно копирует текст выделенного пузырька сообщения в буфер обмена.

### 2. Просмотр последнего произнесённого текста
По умолчанию это дополнение **блокирует Режим обзора (Browse Mode)**, чтобы предотвратить конфликты навигации. Однако это означает, что стандартный просмотровый курсор NVDA (который зависит от виртуального буфера) может не работать для проверки мимолётных объявлений.

Чтобы решить эту проблему, мы предоставляем пользовательский инструмент обзора, который захватывает последний произнесённый вывод:

| Сочетание клавиш | Действие |
| :--- | :--- |
| `NVDA + Стрелка влево/вправо` | Просматривать последний озвученный текст **побуквенно**. |
| `NVDA + Ctrl + Стрелка влево/вправо` | Просматривать последний озвученный текст **пословно**. |

### 3. Фильтрация номеров телефонов
Групповые чаты часто загромождаются номерами телефонов, не сохранёнными в контактах, что делает заголовки чатов многословными и трудными для восприятия.

Это дополнение включает интеллектуальный **фильтр**, который удаляет номера телефонов из имён объектов как в **речи**, так и на **брайлевском дисплее**, обеспечивая гораздо более чистый интерфейс.

*   **Переключить фильтр (`Ctrl + Shift + E`):** Мгновенно включить или отключить фильтр. Вы также можете установить постоянное предпочтение в настройках дополнения.

### 4. Умное отключение «Подсказок по использованию»
WhatsApp часто добавляет повторяющиеся инструкции к каждому элементу чата (например, *«Для дополнительных параметров нажмите стрелку влево или вправо...»*). Слышать это в каждом чате утомительно и замедляет работу.

Наш фильтр автоматически распознаёт и **отключает озвучивание этих подсказок**, оставляя только важную информацию: Название чата, Предпросмотр сообщения, Время и Статус.

*   **Как это работает:** Фильтр аккуратно отделяет фактическое содержимое от метаданных, удаляя текст инструкций, но сохраняя важные обновления статуса, такие как *«непрочитано»* или *«есть реакция»*.
*   **Настройка:** Эту функцию можно настроить с помощью параметра «Озвучивать подсказки по использованию при навигации по списку чатов» на панели настроек.

## Обратная связь и участие

Мы приветствуем предложения, сообщения об ошибках и участие в разработке кода.

*   **Электронная почта:** [bredgreene5@gmail.com](mailto:bredgreene5@gmail.com)
*   **GitHub:** Создайте issue или отправьте Pull Request в репозитории проекта.
